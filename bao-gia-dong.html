<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√°o Gi√° D·ª± √Ån Website - HC Eco System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .item-row:hover {
            background-color: #f0fdf4;
        }
        .category-header {
            background: linear-gradient(135deg, #16a34a 0%, #059669 100%);
        }
        @media print {
            .no-print {
                display: none !important;
            }
        }
        .badge-new {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <div class="no-print bg-gradient-to-r from-green-600 to-emerald-600 text-white py-8 shadow-lg">
        <div class="container mx-auto px-4">
            <h1 class="text-4xl font-bold mb-2">üìã B√°o Gi√° D·ª± √Ån Website</h1>
            <p class="text-xl">HC Eco System - Gi·∫£i Ph√°p NƒÉng L∆∞·ª£ng M·∫∑t Tr·ªùi</p>
        </div>
    </div>

    <!-- Controls -->
    <div class="no-print container mx-auto px-4 py-6">
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-semibold mb-2">T√™n kh√°ch h√†ng:</label>
                    <input type="text" id="customerName" value="HC Eco System" 
                        class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2">Ng√†y b√°o gi√°:</label>
                    <input type="date" id="quoteDate" 
                        class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2">Gi·∫£m gi√° (%):</label>
                    <input type="number" id="discountPercent" value="10" min="0" max="100" 
                        class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-green-500"
                        onchange="calculateTotal()">
                </div>
            </div>
            <div class="flex gap-4">
                <button onclick="exportPDF()" 
                    class="flex-1 bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 font-semibold">
                    üìÑ Xu·∫•t PDF
                </button>
                <button onclick="selectAllItems()" 
                    class="flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 font-semibold">
                    ‚úÖ Ch·ªçn t·∫•t c·∫£
                </button>
                <button onclick="deselectAllItems()" 
                    class="flex-1 bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 font-semibold">
                    ‚ùå B·ªè ch·ªçn t·∫•t c·∫£
                </button>
            </div>
        </div>
    </div>

    <!-- Quote Content -->
    <div id="quoteContent" class="container mx-auto px-4 py-6">
        <div class="bg-white rounded-lg shadow-lg p-8">
            <!-- Header Info -->
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">B√ÅO GI√Å D·ª∞ √ÅN WEBSITE</h2>
                <h3 class="text-2xl font-semibold text-green-600 mb-4">HC Eco System - Gi·∫£i Ph√°p NƒÉng L∆∞·ª£ng M·∫∑t Tr·ªùi</h3>
                <p class="text-gray-600">Ng√†y b√°o gi√°: <span id="displayDate"></span></p>
            </div>

            <!-- Project Info -->
            <div class="bg-green-50 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold mb-4">üìå Th√¥ng Tin D·ª± √Ån</h3>
                <div class="grid grid-cols-2 gap-4 text-sm">
                    <div><strong>Kh√°ch h√†ng:</strong> <span id="displayCustomer">HC Eco System</span></div>
                    <div><strong>Lo·∫°i h√¨nh:</strong> Website B√°n H√†ng + T√≠nh To√°n + Gamification</div>
                    <div><strong>T·ªïng s·ªë trang:</strong> <span id="totalPages">26+</span> trang HTML</div>
                    <div><strong>T·ªïng s·ªë API:</strong> <span id="totalAPIs">76+</span> endpoints PHP</div>
                    <div><strong>Database:</strong> 15 b·∫£ng v·ªõi quan h·ªá ph·ª©c t·∫°p</div>
                    <div><strong>Responsive:</strong> ‚úÖ Desktop, Tablet, Mobile</div>
                </div>
            </div>

            <!-- Items Table -->
            <div class="overflow-x-auto mb-8">
                <table class="w-full text-sm" id="itemsTable">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-3 py-3 text-left no-print">‚úì</th>
                            <th class="px-3 py-3 text-left">STT</th>
                            <th class="px-3 py-3 text-left">H·∫°ng m·ª•c c√¥ng vi·ªác</th>
                            <th class="px-3 py-3 text-center no-print">SL</th>
                            <th class="px-3 py-3 text-center">S·ªë l∆∞·ª£ng</th>
                            <th class="px-3 py-3 text-left">ƒê∆°n v·ªã</th>
                            <th class="px-3 py-3 text-right no-print">ƒê∆°n gi√°</th>
                            <th class="px-3 py-3 text-right">ƒê∆°n gi√° (VNƒê)</th>
                            <th class="px-3 py-3 text-right">Th√†nh ti·ªÅn (VNƒê)</th>
                        </tr>
                    </thead>
                    <tbody id="itemsBody">
                        <!-- Items will be inserted here by JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- Summary -->
            <div class="border-t-2 border-gray-300 pt-6">
                <div class="flex justify-end">
                    <div class="w-full md:w-1/2">
                        <div class="flex justify-between py-2 text-lg">
                            <span class="font-semibold">T·ªïng c·ªông (ch∆∞a gi·∫£m gi√°):</span>
                            <span class="font-bold text-green-600" id="subtotal">0 VNƒê</span>
                        </div>
                        <div class="flex justify-between py-2 text-lg text-red-600">
                            <span class="font-semibold">üéÅ Gi·∫£m gi√° (<span id="displayDiscount">10</span>%):</span>
                            <span class="font-bold" id="discountAmount">0 VNƒê</span>
                        </div>
                        <div class="flex justify-between py-3 text-2xl border-t-2 border-green-600">
                            <span class="font-bold">T·ªîNG THANH TO√ÅN:</span>
                            <span class="font-bold text-green-600" id="grandTotal">0 VNƒê</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notes -->
            <div class="mt-8 bg-yellow-50 rounded-lg p-6">
                <h3 class="text-xl font-bold mb-4">üìù Ghi Ch√∫ Quan Tr·ªçng</h3>
                <ul class="space-y-3 text-sm">
                    <li>üí∞ <strong>Voucher gi·∫£m gi√°:</strong> √Åp d·ª•ng khi thanh to√°n ƒë·ªß 100% theo l·ªãch tr√¨nh</li>
                    <li>üõ°Ô∏è <strong>B·∫£o tr√¨:</strong> MI·ªÑN PH√ç 12 th√°ng (bug fixing, t·ªëi ∆∞u performance, b·∫£o m·∫≠t)</li>
                    <li>‚ùå <strong>Kh√¥ng bao g·ªìm:</strong> Th√™m t√≠nh nƒÉng m·ªõi, t·∫°o trang m·ªõi, thay ƒë·ªïi thi·∫øt k·∫ø l·ªõn</li>
                    <li>üåê <strong>Hosting & Domain:</strong> Kh√°ch h√†ng t·ª± ƒëƒÉng k√Ω ho·∫∑c ch√∫ng t√¥i h·ªó tr·ª£ t∆∞ v·∫•n</li>
                    <li>üìú <strong>Quy·ªÅn s·ªü h·ªØu:</strong> Kh√°ch h√†ng s·ªü h·ªØu to√†n b·ªô source code sau khi thanh to√°n ƒë·ªß</li>
                    <li>üíª <strong>C√¥ng ngh·ªá:</strong> HTML5, CSS3, JavaScript, PHP 7.4+, MySQL 5.7+</li>
                </ul>
            </div>

            <!-- Footer -->
            <div class="mt-8 text-center text-sm text-gray-600">
                <p class="font-semibold">Li√™n h·ªá: 0969 397 434 | Website: api.quangphuc.iotsinhvien.io.vn</p>
                <p class="mt-2">B√°o gi√° c√≥ hi·ªáu l·ª±c trong 30 ng√†y k·ªÉ t·ª´ ng√†y ph√°t h√†nh</p>
            </div>
        </div>
    </div>

    <script>
        // Quote data structure
        const quoteData = {
            "üÜï T√çNH NƒÇNG M·ªöI (NEW FEATURES)": [
                { name: "üîß H·ªá th·ªëng D·ªãch v·ª• (Services) - Frontend + Backend", quantity: 1, unit: "Module", price: 1500000, isNew: true },
                { name: "üì∞ H·ªá th·ªëng B√†i vi·∫øt Gi·ªõi thi·ªáu (Intro Posts) - CRUD ƒë·∫ßy ƒë·ªß", quantity: 1, unit: "Module", price: 1800000, isNew: true },
                { name: "üéÅ N√¢ng c·∫•p G√≥i s·∫£n ph·∫©m - Package Categories + Dynamic Highlights", quantity: 1, unit: "Module", price: 2500000, isNew: true },
                { name: "üì¶ Qu·∫£n l√Ω ƒê∆°n h√†ng n√¢ng cao - Duy·ªát ƒë∆°n, c·∫≠p nh·∫≠t tr·∫°ng th√°i", quantity: 1, unit: "Module", price: 800000, isNew: true },
                { name: "üë• H·ªá th·ªëng qu·∫£n l√Ω Users", quantity: 1, unit: "Module", price: 600000, isNew: true },
                { name: "üì§ H·ªá th·ªëng Upload Media n√¢ng cao - Multi-file, validate", quantity: 1, unit: "Module", price: 1200000, isNew: true },
                { name: "üèóÔ∏è Qu·∫£n l√Ω D·ª± √°n (Projects) - CRUD ƒë·∫ßy ƒë·ªß", quantity: 1, unit: "Module", price: 500000, isNew: true },
                { name: "üé´ N√¢ng c·∫•p V√© quay th∆∞·ªüng - Template management", quantity: 1, unit: "Module", price: 400000, isNew: true },
                { name: "üìú 5 Trang Ch√≠nh s√°ch (B·∫£o h√†nh, B·∫£o m·∫≠t, ƒê·ªïi tr·∫£, ƒêi·ªÅu kho·∫£n)", quantity: 5, unit: "Trang", price: 50000, isNew: true },
            ],
            "üíª FRONTEND - HTML PAGES": [
                { name: "Gi·ªõi thi·ªáu c√¥ng ty", quantity: 1, unit: "Trang", price: 50000 },
                { name: "T·∫ßm nh√¨n & S·ª© m·ªánh", quantity: 1, unit: "Trang", price: 50000 },
                { name: "D·ª± √°n & Tin t·ª©c", quantity: 2, unit: "Trang", price: 50000 },
                { name: "Li√™n h·ªá & Tr·ªü th√†nh nh√† ph√¢n ph·ªëi", quantity: 1, unit: "Trang", price: 100000 },
                { name: "L·ªãch s·ª≠ ƒë∆°n h√†ng", quantity: 1, unit: "Trang", price: 100000 },
                { name: "Chi ti·∫øt ƒë∆°n h√†ng", quantity: 1, unit: "Trang", price: 100000 },
                { name: "L·ªãch s·ª≠ kh·∫£o s√°t", quantity: 1, unit: "Trang", price: 100000 },
                { name: "Chi ti·∫øt kh·∫£o s√°t", quantity: 1, unit: "Trang", price: 100000 },
                { name: "Trang ph·∫ßn th∆∞·ªüng c·ªßa t√¥i", quantity: 1, unit: "Trang", price: 100000 },
                { name: "Trang ƒëƒÉng nh·∫≠p", quantity: 1, unit: "Trang", price: 100000 },
                { name: "Trang ƒëƒÉng k√Ω", quantity: 1, unit: "Trang", price: 100000 },
                { name: "Trang qu·∫£n l√Ω h·ªì s∆° (profile)", quantity: 1, unit: "Trang", price: 100000 },
                { name: "Trang b·∫£ng gi√° (pricing) v·ªõi filter ƒë·ªông", quantity: 1, unit: "Trang", price: 200000 },
                { name: "Trang gi·ªè h√†ng v·ªõi c·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng", quantity: 1, unit: "Trang", price: 200000 },
                { name: "Trang ƒë·∫∑t h√†ng (form thanh to√°n, ch·ªçn ƒë·ªãa ch·ªâ)", quantity: 1, unit: "Trang", price: 200000 },
                { name: "Giao di·ªán v√≤ng quay v·ªõi animation", quantity: 1, unit: "Trang", price: 250000 },
                { name: "Logic quay th∆∞·ªüng (random algorithm)", quantity: 1, unit: "Module", price: 250000 },
                { name: "Form kh·∫£o s√°t nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi (T√≠nh to√°n t·ª± ƒë·ªông)", quantity: 1, unit: "Module", price: 500000 },
                { name: "Responsive Design (35+ trang)", quantity: 1, unit: "G√≥i", price: 300000 },
            ],
            "‚öôÔ∏è BACKEND - PUBLIC APIs": [
                { name: "API ƒêƒÉng nh·∫≠p", quantity: 1, unit: "API", price: 200000 },
                { name: "API ƒêƒÉng k√Ω", quantity: 1, unit: "API", price: 200000 },
                { name: "API ƒêƒÉng xu·∫•t", quantity: 1, unit: "API", price: 50000 },
                { name: "API L·∫•y th√¥ng tin user", quantity: 1, unit: "API", price: 100000 },
                { name: "API C·∫≠p nh·∫≠t profile", quantity: 1, unit: "API", price: 100000 },
                { name: "API L·∫•y gi·ªè h√†ng", quantity: 1, unit: "API", price: 100000 },
                { name: "API Gi·ªè h√†ng kh√¥ng auth", quantity: 1, unit: "API", price: 100000 },
                { name: "API Th√™m v√†o gi·ªè", quantity: 1, unit: "API", price: 150000 },
                { name: "API C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng gi·ªè h√†ng", quantity: 1, unit: "API", price: 100000 },
                { name: "API X√≥a kh·ªèi gi·ªè", quantity: 1, unit: "API", price: 100000 },
                { name: "API T·∫°o ƒë∆°n h√†ng", quantity: 1, unit: "API", price: 300000 },
                { name: "API T·∫°o ƒë∆°n t·ª´ items", quantity: 1, unit: "API", price: 200000 },
                { name: "API L·ªãch s·ª≠ ƒë∆°n h√†ng", quantity: 1, unit: "API", price: 100000 },
                { name: "API Chi ti·∫øt ƒë∆°n h√†ng", quantity: 1, unit: "API", price: 100000 },
                { name: "API Danh m·ª•c s·∫£n ph·∫©m public", quantity: 1, unit: "API", price: 50000 },
                { name: "API S·∫£n ph·∫©m public", quantity: 1, unit: "API", price: 100000 },
                { name: "API G√≥i s·∫£n ph·∫©m public", quantity: 1, unit: "API", price: 100000 },
                { name: "API Danh m·ª•c g√≥i public", quantity: 1, unit: "API", price: 50000 },
                { name: "API S·∫£n ph·∫©m kh·∫£o s√°t public", quantity: 1, unit: "API", price: 100000 },
                { name: "API L∆∞u kh·∫£o s√°t", quantity: 1, unit: "API", price: 200000 },
                { name: "API L·ªãch s·ª≠ kh·∫£o s√°t", quantity: 1, unit: "API", price: 100000 },
                { name: "API Chi ti·∫øt kh·∫£o s√°t", quantity: 1, unit: "API", price: 150000 },
                { name: "API L·∫•y v√© quay", quantity: 1, unit: "API", price: 100000 },
                { name: "API S·ª≠ d·ª•ng v√© quay", quantity: 1, unit: "API", price: 150000 },
                { name: "API L·∫•y ph·∫ßn th∆∞·ªüng", quantity: 1, unit: "API", price: 100000 },
                { name: "API L∆∞u ph·∫ßn th∆∞·ªüng", quantity: 1, unit: "API", price: 150000 },
                { name: "API Template ph·∫ßn th∆∞·ªüng", quantity: 1, unit: "API", price: 50000 },
                { name: "API Danh s√°ch t·ªânh", quantity: 1, unit: "API", price: 50000 },
                { name: "API Danh s√°ch qu·∫≠n/huy·ªán", quantity: 1, unit: "API", price: 50000 },
                { name: "API D·ªãch v·ª• public", quantity: 1, unit: "API", price: 100000 },
                { name: "API D·ª± √°n public", quantity: 1, unit: "API", price: 100000 },
                { name: "API B√†i vi·∫øt gi·ªõi thi·ªáu", quantity: 1, unit: "API", price: 100000 },
                { name: "API Ki·ªÉm tra voucher", quantity: 1, unit: "API", price: 100000 },
            ],
            "üîê BACKEND - ADMIN APIs": [
                { name: "Admin Panel HTML (2729 d√≤ng code) - 10 tabs qu·∫£n l√Ω", quantity: 1, unit: "Trang", price: 2000000 },
                { name: "API Ki·ªÉm tra quy·ªÅn admin", quantity: 1, unit: "API", price: 100000 },
                { name: "API Reset password admin", quantity: 1, unit: "API", price: 100000 },
                { name: "API Qu·∫£n l√Ω Danh m·ª•c (CRUD)", quantity: 3, unit: "API", price: 100000 },
                { name: "API Qu·∫£n l√Ω S·∫£n ph·∫©m (CRUD + Upload)", quantity: 4, unit: "API", price: 125000 },
                { name: "API Qu·∫£n l√Ω G√≥i s·∫£n ph·∫©m (CRUD)", quantity: 3, unit: "API", price: 133000 },
                { name: "API Qu·∫£n l√Ω Danh m·ª•c g√≥i (CRUD)", quantity: 3, unit: "API", price: 100000 },
                { name: "API Qu·∫£n l√Ω Kh·∫£o s√°t (CRUD)", quantity: 3, unit: "API", price: 100000 },
                { name: "API Qu·∫£n l√Ω ƒê∆°n h√†ng (Get, Approve, Update)", quantity: 3, unit: "API", price: 150000 },
                { name: "API Qu·∫£n l√Ω V√© quay (CRUD)", quantity: 3, unit: "API", price: 100000 },
                { name: "API Qu·∫£n l√Ω Template th∆∞·ªüng (CRUD)", quantity: 3, unit: "API", price: 100000 },
                { name: "API Qu·∫£n l√Ω D·ªãch v·ª• (CRUD)", quantity: 3, unit: "API", price: 100000 },
                { name: "API Qu·∫£n l√Ω D·ª± √°n (CRUD)", quantity: 3, unit: "API", price: 100000 },
                { name: "API Qu·∫£n l√Ω B√†i vi·∫øt gi·ªõi thi·ªáu (CRUD)", quantity: 3, unit: "API", price: 117000 },
                { name: "API Upload Media (Logo, Product, Intro)", quantity: 3, unit: "API", price: 133000 },
                { name: "API Qu·∫£n l√Ω Users", quantity: 1, unit: "API", price: 150000 },
            ],
            "üß© CORE & JAVASCRIPT": [
                { name: "Core Backend Files (Config, Connect, Auth, Session)", quantity: 5, unit: "Module", price: 100000 },
                { name: "JavaScript Authentication Logic", quantity: 1, unit: "Module", price: 150000 },
                { name: "JavaScript Shopping Cart", quantity: 1, unit: "Module", price: 200000 },
                { name: "JavaScript Cart Page UI", quantity: 1, unit: "Module", price: 150000 },
                { name: "JavaScript Checkout Logic", quantity: 1, unit: "Module", price: 200000 },
                { name: "JavaScript Lottery Wheel", quantity: 1, unit: "Module", price: 250000 },
                { name: "JavaScript Pricing Page", quantity: 1, unit: "Module", price: 150000 },
                { name: "JavaScript Slideshow", quantity: 1, unit: "Module", price: 100000 },
                { name: "JavaScript Theme Toggle (Dark mode)", quantity: 1, unit: "Module", price: 100000 },
                { name: "JavaScript Admin Main Logic", quantity: 1, unit: "Module", price: 500000 },
                { name: "JavaScript Admin Products", quantity: 1, unit: "Module", price: 200000 },
                { name: "JavaScript Admin Packages", quantity: 1, unit: "Module", price: 200000 },
            ],
            "üíæ DATABASE & DEPLOYMENT": [
                { name: "Thi·∫øt k·∫ø Database Schema (15 b·∫£ng thay v√¨ 11)", quantity: 1, unit: "G√≥i", price: 500000 },
                { name: "C·∫•u h√¨nh Server & Hosting", quantity: 1, unit: "G√≥i", price: 100000 },
                { name: "C·∫•u h√¨nh Database Production", quantity: 1, unit: "G√≥i", price: 100000 },
                { name: "Testing tr√™n m√¥i tr∆∞·ªùng Production", quantity: 1, unit: "G√≥i", price: 100000 },
                { name: "Deploy Code & Assets", quantity: 1, unit: "G√≥i", price: 50000 },
            ]
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('quoteDate').value = today;
            document.getElementById('displayDate').textContent = formatDate(today);
            
            renderItems();
            calculateTotal();
        });

        // Update customer name
        document.getElementById('customerName').addEventListener('input', function() {
            document.getElementById('displayCustomer').textContent = this.value;
        });

        // Update date
        document.getElementById('quoteDate').addEventListener('change', function() {
            document.getElementById('displayDate').textContent = formatDate(this.value);
        });

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const day = date.getDate();
            const month = date.getMonth() + 1;
            const year = date.getFullYear();
            return `${day} th√°ng ${month}, ${year}`;
        }

        function renderItems() {
            const tbody = document.getElementById('itemsBody');
            tbody.innerHTML = '';
            let stt = 1;

            Object.keys(quoteData).forEach(category => {
                // Category header
                const catRow = document.createElement('tr');
                catRow.className = 'category-header text-white font-bold';
                catRow.innerHTML = `
                    <td colspan="9" class="px-3 py-3">${category}</td>
                `;
                tbody.appendChild(catRow);

                // Items
                quoteData[category].forEach((item, index) => {
                    const row = document.createElement('tr');
                    row.className = 'item-row border-b';
                    row.dataset.category = category;
                    row.dataset.index = index;
                    
                    const subtotal = item.quantity * item.price;
                    
                    row.innerHTML = `
                        <td class="px-3 py-2 no-print">
                            <input type="checkbox" checked onchange="calculateTotal()" 
                                class="item-checkbox w-5 h-5 text-green-600">
                        </td>
                        <td class="px-3 py-2 text-center">${stt}</td>
                        <td class="px-3 py-2">
                            ${item.name}
                            ${item.isNew ? '<span class="badge-new ml-2 bg-red-500 text-white px-2 py-1 rounded text-xs font-bold">‚≠ê M·ªöI</span>' : ''}
                        </td>
                        <td class="px-3 py-2 text-center no-print">
                            <input type="number" value="${item.quantity}" min="0" step="0.1"
                                class="item-quantity w-20 px-2 py-1 border rounded text-center"
                                onchange="updateQuantity(this, '${category}', ${index})">
                        </td>
                        <td class="px-3 py-2 text-center quantity-display">${item.quantity}</td>
                        <td class="px-3 py-2">${item.unit}</td>
                        <td class="px-3 py-2 text-right no-print">
                            <input type="number" value="${item.price}" min="0" step="1000"
                                class="item-price w-32 px-2 py-1 border rounded text-right"
                                onchange="updatePrice(this, '${category}', ${index})">
                        </td>
                        <td class="px-3 py-2 text-right price-display">${formatCurrency(item.price)}</td>
                        <td class="px-3 py-2 text-right font-semibold subtotal-display">${formatCurrency(subtotal)}</td>
                    `;
                    tbody.appendChild(row);
                    stt++;
                });
            });
        }

        function updateQuantity(input, category, index) {
            quoteData[category][index].quantity = parseFloat(input.value) || 0;
            const row = input.closest('tr');
            const price = quoteData[category][index].price;
            const subtotal = quoteData[category][index].quantity * price;
            row.querySelector('.quantity-display').textContent = input.value;
            row.querySelector('.subtotal-display').textContent = formatCurrency(subtotal);
            calculateTotal();
        }

        function updatePrice(input, category, index) {
            quoteData[category][index].price = parseFloat(input.value) || 0;
            const row = input.closest('tr');
            const quantity = quoteData[category][index].quantity;
            const subtotal = quantity * quoteData[category][index].price;
            row.querySelector('.price-display').textContent = formatCurrency(quoteData[category][index].price);
            row.querySelector('.subtotal-display').textContent = formatCurrency(subtotal);
            calculateTotal();
        }

        function calculateTotal() {
            let total = 0;
            const checkboxes = document.querySelectorAll('.item-checkbox:checked');
            
            checkboxes.forEach(checkbox => {
                const row = checkbox.closest('tr');
                const category = row.dataset.category;
                const index = parseInt(row.dataset.index);
                const item = quoteData[category][index];
                total += item.quantity * item.price;
            });

            const discount = parseFloat(document.getElementById('discountPercent').value) || 0;
            const discountAmount = total * (discount / 100);
            const grandTotal = total - discountAmount;

            document.getElementById('subtotal').textContent = formatCurrency(total);
            document.getElementById('displayDiscount').textContent = discount;
            document.getElementById('discountAmount').textContent = '- ' + formatCurrency(discountAmount);
            document.getElementById('grandTotal').textContent = formatCurrency(grandTotal);
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('vi-VN').format(Math.round(amount)) + ' VNƒê';
        }

        function selectAllItems() {
            document.querySelectorAll('.item-checkbox').forEach(cb => cb.checked = true);
            calculateTotal();
        }

        function deselectAllItems() {
            document.querySelectorAll('.item-checkbox').forEach(cb => cb.checked = false);
            calculateTotal();
        }

        function exportPDF() {
            const element = document.getElementById('quoteContent');
            const opt = {
                margin: 10,
                filename: `Bao-gia-HC-Eco-${new Date().toISOString().split('T')[0]}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            
            // Hide editable inputs before PDF export
            document.querySelectorAll('.no-print').forEach(el => el.style.display = 'none');
            
            html2pdf().set(opt).from(element).save().then(() => {
                document.querySelectorAll('.no-print').forEach(el => el.style.display = '');
            });
        }
    </script>
</body>
</html>

